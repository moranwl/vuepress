(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{379:function(t,a,s){"use strict";s.r(a);var e=s(0),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"powershell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#powershell"}},[t._v("#")]),t._v(" PowerShell")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#flag"}},[t._v("Flag")])]),a("li",[a("a",{attrs:{href:"#包管理"}},[t._v("包管理")])]),a("li",[a("a",{attrs:{href:"#在batch中嵌入运行"}},[t._v("在batch中嵌入运行")])]),a("li",[a("a",{attrs:{href:"#windows10自带应用"}},[t._v("Windows10自带应用")])]),a("li",[a("a",{attrs:{href:"#随机字符串"}},[t._v("随机字符串")])]),a("li",[a("a",{attrs:{href:"#http服务"}},[t._v("HTTP服务")])]),a("li",[a("a",{attrs:{href:"#弹窗"}},[t._v("弹窗")]),a("ul",[a("li",[a("a",{attrs:{href:"#获取所有com组件"}},[t._v("获取所有COM组件")])])])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"flag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[t._v("#")]),t._v(" Flag")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("PowerShell")]),t._v("的命令叫做"),a("code",[t._v("cmdlet")]),t._v("("),a("code",[t._v("command-let")]),t._v("), 采用了“动词-名词”的命名方式，动词部分取自于一个制定的动词集合，\n名词部分则描述了命令要操作的对象。例如，"),a("code",[t._v("Get-Command")]),t._v("就是指获取"),a("code",[t._v("PowerShell")]),t._v("中所有"),a("code",[t._v("cmdlet")]),t._v("命令。")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("PowerShell")]),t._v("提供对"),a("code",[t._v("COM")]),t._v("（组件对象模型）和"),a("code",[t._v("WMI")]),t._v("（Windows管理规范）的完全访问，具有丰富的控制与自动化的系统管理能力，\n能够轻松地做到实时、大规模的管理系统。获取本机所有"),a("code",[t._v("COM")]),t._v("组件对象脚本 "),a("a",{attrs:{href:"/files/Get-COM-Objects.ps1"}},[t._v("Get-COM-Objects.ps1")])])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/janikvonrotz/awesome-powershell",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/janikvonrotz/awesome-powershell"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/PowerShell",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/PowerShell"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.zhihu.com/question/22611859/answers/updated",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell 与 cmd 有什么不同？"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/zh-cn/powershell"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/cimcmdlets/?view=powershell-7.1",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell参考文档"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.pstips.net/why-is-powershell-powerful.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell为什么强大"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.pstips.net/powershell-online-tutorials",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell 在线教程"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/60797627",target:"_blank",rel:"noopener noreferrer"}},[t._v("Powershell入门指南(一)·PowerShell及CLI发展"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/60798130",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell入门指南(二)·挑战CMD和Bash的PowerShell"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/76708298",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell入门指南(三)·一门新的编程语言"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.pstips.net/speeding-up-powershell-multithreading.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell提速和多线程"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/MerLin-LiuNian/category/2027025.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell - 随笔分类 - 门前有根大呲花 - 博客园"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("WMIC 已弃用替代品 "),a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/microsoft.powershell.management/get-wmiobject",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get-WmiObject"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("WMIC 已弃用替代品 "),a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/powershell/module/cimcmdlets/get-ciminstance",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get-CimInstance"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://forsenergy.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://forsenergy.com"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.yiibai.com/powershell",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.yiibai.com/powershell"),a("OutboundLink")],1)])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/R3MRUM/PSDecode",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/R3MRUM/PSDecode"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/rootclay/Powershell-Attack-Guide",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/rootclay/Powershell-Attack-Guide"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/rootclay/Windows-Access-Control",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/rootclay/Windows-Access-Control"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"包管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#包管理"}},[t._v("#")]),t._v(" 包管理")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/microsoft/winget-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/microsoft/winget-cli"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/microsoft/winget-pkgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/microsoft/winget-pkgs"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/package-manager/winget",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/zh-cn/windows/package-manager/winget"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/oneget/oneget",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/oneget/oneget"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.nuget.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.nuget.org"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.powershellgallery.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.powershellgallery.com"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/chocolatey",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/chocolatey"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://chocolatey.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://chocolatey.org"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/lukesampson/scoop",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/lukesampson/scoop"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/ScoopInstaller",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/ScoopInstaller"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/lukesampson/scoop-extras",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/lukesampson/scoop-extras"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/cmderdev/cmder",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/cmderdev/cmder"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/appget",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/appget"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"在batch中嵌入运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在batch中嵌入运行"}},[t._v("#")]),t._v(" 在batch中嵌入运行")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/Captain_RB/article/details/111604033",target:"_blank",rel:"noopener noreferrer"}},[t._v("PowerShell常用命令及使用方法"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("由于Power Shell默认没有开启运行脚本策略，可以以此方式解决")])]),t._v(" "),a("blockquote",[a("p",[t._v("正则表达式排除以"),a("code",[t._v("@")]),t._v("和"),a("code",[t._v(":")]),t._v("开头的行，并将其他所有内容传递给Power Shell")])]),t._v(" "),a("div",{staticClass:"language-batch extra-class"},[a("pre",{pre:!0,attrs:{class:"language-batch"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("@")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("findstr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("/v")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^@.* ^:.*"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%~f0"')]),t._v("|powershell -WindowStyle Hidden -ExecutionPolicy Bypass -")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v(":eof")])]),t._v("\n<# 从这里开始是 Power Shell代码 #>\n")])])]),a("blockquote",[a("p",[t._v("这里巧妙的借用Power Shell的注释把bat脚本命令包裹，把整个脚本内容传入Power Shell并执行")])]),t._v(" "),a("div",{staticClass:"language-batch extra-class"},[a("pre",{pre:!0,attrs:{class:"language-batch"}},[a("code",[t._v("<# ::\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("@")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("powershell")]),t._v(" -WindowStyle Hidden -ExecutionPolicy Bypass -<"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("%~f0")]),t._v(" ")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("goto")]),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v(":eof")])]),t._v("\n#>\n# 保存到bat文件中可以双击执行，从这里开始是Power Shell代码\n")])])]),a("h2",{attrs:{id:"windows10自带应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows10自带应用"}},[t._v("#")]),t._v(" Windows10自带应用")]),t._v(" "),a("blockquote",[a("p",[t._v("注意空格和英文标点")])]),t._v(" "),a("ul",[a("li",[t._v("查看已安装应用")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select")]),t._v(" Name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("PackageFullName\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看Windows已装的自带应用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxProvisionedPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("online "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用清单获取安装位置")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loc")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Split-Path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[Environment]")]),t._v("::ExpandEnvironmentVariables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstallLocation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Parent\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Split-Path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Leaf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ieq "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AppxMetadata'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loc")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Split-Path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Parent\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取查找相关文件夹的模式")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$matching")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Join-Path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Path "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Split-Path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ChildPath "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DisplayName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),t._v('*"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$size")]),t._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{0:N2}MB"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("f "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-ChildItem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$matching")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Recurse "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ErrorAction Ignore "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Measure-Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Property Length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Sum\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" 1MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将结果添加到输出")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-Member")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("NotePropertyName Size "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("NotePropertyValue "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$size")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-Member")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("NotePropertyName InstallFolder "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("NotePropertyValue "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loc")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Select")]),t._v(" DisplayName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" PackageName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" InstallFolder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Size\n")])])]),a("ul",[a("li",[t._v("卸载应用程序")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 卸载所有账户中的应用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AllUsers "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-AppxPackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 从系统账户中卸载应用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppXProvisionedPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("online "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-AppxProvisionedPackage")]),t._v(" –online\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 应用商店")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("store* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-Appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日历、邮件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" Microsoft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("windowscommunicationsapps "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Remove-AppxPackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("communicationsapps* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 从系统账户中卸载日历、邮件应用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppXProvisionedPackage")]),t._v(" –online "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("where-object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("packagename –like "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*windowsmunicationsapps*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxprovisionedpackage")]),t._v(" –online\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 人脉")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("people* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Groove 音乐")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("zunemusic* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 电影和电视")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("zunevideo* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 财经")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("bingfinance* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 资讯")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("bingnews* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 体育")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("bingsports* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 天气")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("bingweather* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# OneNote")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("onenote* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 便笺 https://onenote.com/stickynotes")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("stickynotes* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# TODO https://to-do.microsoft.com")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# https://www.microsoft.com/zh-cn/microsoft-365/microsoft-to-do-list-app")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("todo* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 闹钟和时钟")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("alarms* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 计算器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("calculator* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 相机")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("camera* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 照片")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("photos* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 地图")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("maps* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 录音机")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("soundrecorder* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# XBox")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("xbox* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove-appxpackage")]),t._v("\n")])])]),a("ul",[a("li",[t._v("恢复应用程序")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 应用商店")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add-appxpackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("register "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:\\Program Files\\WindowsApps\\*Store*\\AppxManifest.xml"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("disabledevelopmentmode\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 计算器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("calculator* "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AllUsers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Foreach")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("`\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DisableDevelopmentMode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Register "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstallLocation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),t._v('\\AppXManifest.xml"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日历、邮件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-AppxPackage")]),t._v(" Microsoft"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("windowscommunicationsapps "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AllUsers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Foreach")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("`\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-AppxPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DisableDevelopmentMode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Register "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("InstallLocation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),t._v('\\AppXManifest.xml"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"随机字符串"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#随机字符串"}},[t._v("#")]),t._v(" 随机字符串")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("48..57")]),t._v("是数字0-9，powershell的范围操作符是"),a("code",[t._v("..")]),t._v("，"),a("code",[t._v("65..90")]),t._v("是大写字符A到Z，"),a("code",[t._v("97..122")]),t._v("是小写字母。\n如果需要获取多有的可打印字符（包括空格）的话，范围是"),a("code",[t._v("32..127")]),t._v("。")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("[char]")]),t._v("把对应数字转换成字符，例如 "),a("code",[t._v("[char](66)")]),t._v("就是B(大写字母B)，C语言使用的小括号来进行类型强制转换。")])]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果不指定-count参数，则前面的list有多少个字符")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# get-random就会获取多少个字符，只是顺序打乱了")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("48"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("57 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 65"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("90 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 97"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("122"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get-random")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("count 6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出19位数字字符串并在开头拼接x")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Random")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("count 19"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"X"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里的0..1024相当于循环控制，每循环一次|后面的代码执行一次，")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 其中在数字字母中随机选一个字符 0..1024, like Perl, loop controller")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1024"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char]")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[int]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("48"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("57 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 65"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("90 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" 97"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("122"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-join")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char[]]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("65"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("90+97"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("122"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-Random")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Count 6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add-Type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AssemblyName System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[System.Web.Security.Membership]")]),t._v("::GeneratePassword"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("20"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-RandomString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("param")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[int]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$length")]),t._v("=10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里的[int]是类型指定")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char[]]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sourcedata")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loop")]),t._v("=1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loop")]),t._v(" –le "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$length")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$loop")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TempPassword")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sourcedata")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GET-RANDOM")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[char]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TempPassword")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get-RandomString")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("length 14 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("sourcedata "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("48"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("127"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"http服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http服务"}},[t._v("#")]),t._v(" HTTP服务")]),t._v(" "),a("div",{staticClass:"language-ps1 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('start-job { \n    $p="d:\\"\n    #$p = Get-Location.path #获取当前用户的目录\n    $H=New-Object Net.HttpListener\n    $H.Prefixes.Add("http://+:8889/")\n    $H.Start()\n    While ($H.IsListening) {\n        $HC=$H.GetContext()\n        $HR=$HC.Response\n        $HR.Headers.Add("Content-Type","text/plain")\n\n        $file=Join-Path $p ($HC.Request).RawUrl\n        $text=[IO.File]::ReadAllText($file)\n        $text=[Text.Encoding]::UTF8.GetBytes($text)\n\n        $HR.ContentLength64 = $text.Length\n        $HR.OutputStream.Write($text,0,$text.Length)\n        $HR.Close()\n    }\n    $H.Stop()\n}\n')])])]),a("h2",{attrs:{id:"弹窗"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#弹窗"}},[t._v("#")]),t._v(" 弹窗")]),t._v(" "),a("div",{staticClass:"language-ps1 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$xaml = @\"\n<Window xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation'>\n <Border BorderThickness='20' BorderBrush='Yellow' CornerRadius='9' Background='Red'>\n  <StackPanel>\n   <Label FontSize='50' FontFamily='Stencil' Background='Red' Foreground='White' BorderThickness='0'>\n    System will be rebooted in 15 minutes!\n   </Label>\n   <Label HorizontalAlignment='Center' FontSize='15' FontFamily='Consolas' Background='Red' Foreground='White' BorderThickness='0'>\n    Worried about losing data? Talk to your friendly help desk representative and freely share your concerns!\n   </Label>\n  </StackPanel>\n </Border>\n</Window>\n\"@;\nAdd-Type -assemblyName PresentationFramework;\n$reader = [System.XML.XMLReader]::Create([System.IO.StringReader] $xaml);\n$window = [System.Windows.Markup.XAMLReader]::Load($reader);\n$Window.AllowsTransparency = $True;\n$window.SizeToContent = 'WidthAndHeight';\n$window.ResizeMode = 'NoResize';\n$Window.Opacity = .7;\n$window.Topmost = $true;\n$window.WindowStartupLocation = 'CenterScreen';\n$window.WindowStyle = 'None';\n$null = $window.Show();\nStart-Sleep -Seconds 10;\n$window.Close();\n")])])]),a("h3",{attrs:{id:"获取所有com组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取所有com组件"}},[t._v("#")]),t._v(" 获取所有COM组件")]),t._v(" "),a("div",{staticClass:"language-ps1 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("gci HKLM:\\Software\\Classes -ea 0| ? {$_.PSChildName -match '^\\w+\\.\\w+$' -and (gp \"$($_.PSPath)\\CLSID\" -ea 0)} | ft PSChildName\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);
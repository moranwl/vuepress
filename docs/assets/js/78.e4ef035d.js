(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{392:function(t,a,e){"use strict";e.r(a);var s=e(0),r=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"linux网络防火墙"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux网络防火墙"}},[t._v("#")]),t._v(" Linux网络防火墙")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#flag"}},[t._v("Flag")])]),a("li",[a("a",{attrs:{href:"#查看网络"}},[t._v("查看网络")])]),a("li",[a("a",{attrs:{href:"#iptables"}},[t._v("iptables")])]),a("li",[a("a",{attrs:{href:"#ufw"}},[t._v("UFW")])]),a("li",[a("a",{attrs:{href:"#firewalld"}},[t._v("firewalld")])]),a("li",[a("a",{attrs:{href:"#路由跟踪"}},[t._v("路由跟踪")])]),a("li",[a("a",{attrs:{href:"#网卡"}},[t._v("网卡")]),a("ul",[a("li",[a("a",{attrs:{href:"#mtu"}},[t._v("MTU")])])])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"flag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flag"}},[t._v("#")]),t._v(" Flag")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("nethogs")]),t._v(": 按进程查看流量占用")]),t._v(" "),a("li",[a("code",[t._v("ethtool")]),t._v(": 诊断工具")]),t._v(" "),a("li",[a("code",[t._v("tcpdump")]),t._v(": 抓包工具")]),t._v(" "),a("li",[t._v("监控总体带宽使用："),a("code",[t._v("nload")]),t._v("、"),a("code",[t._v("bmon")]),t._v("、"),a("code",[t._v("slurm")]),t._v("、"),a("code",[t._v("bwm-ng")]),t._v("、"),a("code",[t._v("cbm")]),t._v("、"),a("code",[t._v("speedometer")]),t._v("、"),a("code",[t._v("netload")])]),t._v(" "),a("li",[t._v("监控总体带宽使用（批量式输出）："),a("code",[t._v("vnstat")]),t._v("、"),a("code",[t._v("ifstat")]),t._v("、"),a("code",[t._v("dstat")]),t._v("、"),a("code",[t._v("collectl")])]),t._v(" "),a("li",[t._v("每个套接字连接的带宽使用："),a("code",[t._v("iftop")]),t._v("、"),a("code",[t._v("iptraf")]),t._v("、"),a("code",[t._v("tcptrack")]),t._v("、"),a("code",[t._v("pktstat")]),t._v("、"),a("code",[t._v("netwatch")]),t._v("、"),a("code",[t._v("trafshow")]),t._v("、"),a("code",[t._v("jnettop")])]),t._v(" "),a("li",[a("code",[t._v("ntopng")])]),t._v(" "),a("li",[t._v("perf、sar、ksar、mpstat、uptime、vmstat、pidstat、time、cpustat、munin、glances、atop、nmon、pcp-gui、nfsstat、netstat、iostat")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/htop-dev/htop",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/htop-dev/htop"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("视图监视器 "),a("a",{attrs:{href:"https://github.com/paradoxxxzero/gnome-shell-system-monitor-applet",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/paradoxxxzero/gnome-shell-system-monitor-applet"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/aristocratos",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/aristocratos"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"查看网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看网络"}},[t._v("#")]),t._v(" 查看网络")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询系统中缓存的ARP表，ARP表用来维护IP地址与MAC地址的对应关系")]),t._v("\narp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-an")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ip")]),t._v(" a\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ifconfig")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出当前的ESTABLISHED和TIME_WAIT数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("netstat")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-n")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("netstat")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-ant")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\n    {++s[$NF]} END {for(k in s) print k,s[k]}\n'")]),t._v("\nss "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-ant")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\n    {++s[$1]} END {for(k in s) print k,s[k]}\n'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 详情")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("netstat")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-antp")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打印所有进程及其线程")]),t._v("\npstree "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打印某个进程的线程数")]),t._v("\npstree "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打印当前地址IP链接情况")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("netstat")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-antp")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ESTABLISHED"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print $5}'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-F")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print $4}'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("uniq")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"iptables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#iptables"}},[t._v("#")]),t._v(" iptables")]),t._v(" "),a("ul",[a("li",[t._v("iptables "),a("a",{attrs:{href:"https://www.netfilter.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.netfilter.org"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("iptables是Linux从2.4.x版本内核开始，系统自带的防火墙。随着Linux内核的不断更新，Linux的防火墙在iptables基础上泛生出\nUFW和Firewalld，并且在一些发行版中已经替代iptables。")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#永久关闭防火墙")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chkconfig")]),t._v(" iptables off\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 永久关闭后启用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chkconfig")]),t._v(" iptables on\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看防火墙规则")]),t._v("\niptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-L")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查出所有的规则信息")]),t._v("\niptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-nvl")]),t._v("\niptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-L")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-n")]),t._v(" --line-number\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 清空已存在的规则")]),t._v("\niptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-F")]),t._v("\niptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--flush")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sudo iptables -I INPUT -p tcp --dport [端口号] -j ACCEPT")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# --dport 目标端口，数据从外部进入服务器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# --sport 数据源端口，数据从服务器出去")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" iptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-I")]),t._v(" INPUT "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" ACCEPT\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 保存iptables设置规则")]),t._v("\niptables-save\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装iptables-persistent工具，使端口配置持久化")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" iptables-persistent\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 端口配置永久生效 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" netfilter-persistent save\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" netfilter-persistent reload\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成的规则将被存储在以下文件中:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/iptables/rules.v4")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/iptables/rules.v6")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"ufw"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ufw"}},[t._v("#")]),t._v(" UFW")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ufw\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检查 UFW 的状态")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw status verbose\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打开防火墙")]),t._v("\nufw "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭防火墙")]),t._v("\nufw disable\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#重启防火墙")]),t._v("\nufw reload\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看已经定义的ufw规则")]),t._v("\nufw status\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 外来访问默认允许")]),t._v("\nufw default allow\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 外来访问默认拒绝")]),t._v("\nufw default deny\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许访问20端口，20后可跟/tcp或/udp，表示tcp或udp封包。")]),t._v("\nufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 拒绝访问20端口，20后可跟/tcp或/udp，表示tcp或udp封包。")]),t._v("\nufw deny "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许自192.168.0.0/24的tcp封包访问本机的22端口。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw allow proto tcp from "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.0/24 to any port "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 删除以前定义的"允许访问20端口"的规则')]),t._v("\nufw delete allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 删除以前定义的"拒绝访问20端口"的规则')]),t._v("\nufw delete deny "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n")])])]),a("h2",{attrs:{id:"firewalld"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#firewalld"}},[t._v("#")]),t._v(" firewalld")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看firewalld状态，发现当前是dead状态，即防火墙未开启。")]),t._v("\nsystemctl status firewalld\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启防火墙，没有任何提示即开启成功。")]),t._v("\nsystemctl start firewalld\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看已开放的端口(默认不开放任何端口)")]),t._v("\nfirewall-cmd --list-ports\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重启防火墙")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--reload")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止防火墙")]),t._v("\nsystemctl stop firewalld.service\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 禁止防火墙开机启动")]),t._v("\nsystemctl disable firewalld.service\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除端口")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" public --remove-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启80端口")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启8080-8089的IP端")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("-8089/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启3306端口")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v("--zone")]),t._v(" 作用域")]),t._v(" "),a("li",[a("code",[t._v("--add-port=80/tcp")]),t._v(" 添加端口，格式为：端口/通讯协议")]),t._v(" "),a("li",[a("code",[t._v("--permanent")]),t._v(" 永久生效，没有此参数重启后失效")])]),t._v(" "),a("p",[a("strong",[t._v("配置"),a("code",[t._v("firewalld-cmd")])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看版本")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--version")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看帮助")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--help")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 显示状态")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--state")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有打开的端口")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --list-ports\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 更新防火墙规则")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--reload")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看区域信息")]),t._v("\nfirewall-cmd --get-active-zones\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看指定接口所属区域")]),t._v("\nfirewall-cmd --get-zone-of-interface"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eth0\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 拒绝所有包")]),t._v("\nfirewall-cmd --panic-on\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 取消拒绝状态")]),t._v("\nfirewall-cmd --panic-off\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看是否拒绝")]),t._v("\nfirewall-cmd --query-panic\n")])])]),a("h2",{attrs:{id:"路由跟踪"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由跟踪"}},[t._v("#")]),t._v(" 路由跟踪")]),t._v(" "),a("ul",[a("li",[t._v("查询IP地理信息 "),a("a",{attrs:{href:"https://github.com/zu1k/nali",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/zu1k/nali"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("DNS扫描 "),a("a",{attrs:{href:"https://github.com/pwnesia/dnstake",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/pwnesia/dnstake"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/zartbot/ztrace",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/zartbot/ztrace"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("strong",[a("code",[t._v("ping")]),t._v("、"),a("code",[t._v("tcptraceroute")]),t._v("、"),a("code",[t._v("traceroute")]),t._v("、"),a("code",[t._v("mtr")])])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/xzkzzz/p/7413177.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.cnblogs.com/xzkzzz/p/7413177.html"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/802010d54849",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.jianshu.com/p/802010d54849"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1332118",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cloud.tencent.com/developer/article/1332118"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://winmtr.net/download-winmtr",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://winmtr.net/download-winmtr"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/dalianpai/p/12505678.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Netcat详解"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://www.dest-unreach.org/socat",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.dest-unreach.org/socat"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/vi/websocat",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/vi/websocat"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("在Linux中有一个更好的网络连通性判断工具，它可以结合ping | nslookup | tracert 来判断网络的相关特性，这个命令就是mtr。")])]),t._v(" "),a("blockquote",[a("p",[t._v("注意：MTR使用的raw sockets是绕过TCP/IP协议，需要ROOT权限来执行，因此如果以普通用户身份来执行mtr会出错，\n提示“mtr: unable to get raw sockets”")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://www.vdberg.org/~richard/tcpping.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("tcpping- 禁止了ICMP协议（ping命令）也能用"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/deajan/tcpping",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/deajan/tcpping"),a("OutboundLink")],1)])])])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("tcpping")]),t._v("脚本依赖"),a("code",[t._v("tcptraceroute")]),t._v(" 组件，所以必须先安装"),a("code",[t._v("yum install tcptraceroute")])])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://elifulkerson.com/projects/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://elifulkerson.com/projects/"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("注意"),a("code",[t._v("tcpping")]),t._v("与"),a("code",[t._v("tcping")]),t._v(" 是不同的两款工具")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/sysinternals/downloads/psping",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/zh-cn/sysinternals/downloads/psping"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://code.google.com/archive/p/paping/downloads",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://code.google.com/archive/p/paping/downloads"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("PsPing")]),t._v(" 是微软 "),a("code",[t._v("PSTools")]),t._v(" 工具套件中的其中一个命令。除了 "),a("code",[t._v("ICMP")]),t._v(" ping 测试，主要用来测试 TCP 端口的连通性，\n还可以测试 "),a("code",[t._v("TCP/UDP")]),t._v(" 网络时延和带宽。不过， "),a("code",[t._v("PsPing")]),t._v(" 只能在 Windows 中运行。Linux 可以使用 "),a("code",[t._v("PaPing")]),t._v(" （跨平台的开源工具）。")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/antirez/hping",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/antirez/hping"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("strong",[t._v("常用网站")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://ipcheck.need.sh",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://ipcheck.need.sh"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://torch.njs.app",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://torch.njs.app"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("瓦工的全球ping工具 "),a("a",{attrs:{href:"http://ping.pe",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://ping.pe"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.yougetsignal.com/tools/open-ports",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.yougetsignal.com/tools/open-ports"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://tool.chinaz.com/port",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://tool.chinaz.com/port"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.websitepulse.com/tools/china-firewall-test",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.websitepulse.com/tools/china-firewall-test"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.vps234.com/ipchecker",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.vps234.com/ipchecker"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://tools.ipip.net/traceroute.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://tools.ipip.net/traceroute.php"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("IP范围转换CIDR "),a("a",{attrs:{href:"https://ip2cidr.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://ip2cidr.com"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://apps.neu.edu.cn/netaggr",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://apps.neu.edu.cn/netaggr"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.sioe.cn/xinqing/CIDR.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("无类别域间路由（CIDR）网络地址计算器"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zh.rakko.tools/tools/27",target:"_blank",rel:"noopener noreferrer"}},[t._v("IPv4 / IPv6 CIDR计算器 | RAKKOTOOLS🔧"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://ip.chacuo.net/ipconvert",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://ip.chacuo.net/ipconvert"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/3th1nk/cidr",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/3th1nk/cidr"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.oldking.net",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.oldking.net"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("strong",[t._v("tracert")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("Tracert")]),t._v(" 列出分组经过的路由节点，以及它在IP 网络中每一跳的延迟（这里的延迟是指：分组从信息源发送到目的地所需的时间，\n延迟也分为许多的种类——传播延迟、传输延迟、处理延迟、排队延迟等，是大多数网站性能的瓶颈之一）.")])]),t._v(" "),a("div",{staticClass:"language-batch extra-class"},[a("pre",{pre:!0,attrs:{class:"language-batch"}},[a("code",[a("span",{pre:!0,attrs:{class:"token command"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tracert")]),t._v(" ["),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-d")]),t._v("] ["),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-h")]),t._v(" maximum_hops] ["),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-j")]),t._v(" host-list] ["),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-w")]),t._v(" timeout] ["),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-R")]),t._v("] ["),a("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-S")]),t._v(" srcaddr] ["),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("-4")]),t._v("] ["),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("-6")]),t._v("] target_name")]),t._v("\n")])])]),a("p",[a("strong",[t._v("选项")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("-d")]),t._v(" 指定不将 IP 地址解析到主机名称。")]),t._v(" "),a("li",[a("code",[t._v("-h maximum_hops")]),t._v(" 指定跃点数以跟踪到称为 target_name 的主机的路由。")]),t._v(" "),a("li",[a("code",[t._v("-j host-list")]),t._v(" 指定 Tracert 实用程序数据包所采用路径中的路由器接口列表。")]),t._v(" "),a("li",[a("code",[t._v("-w timeout")]),t._v(" 等待 timeout 为每次回复所指定的毫秒数。")]),t._v(" "),a("li",[a("code",[t._v("target_name")]),t._v(" 目标主机的名称或 IP 地址。")])]),t._v(" "),a("p",[a("strong",[t._v("示例")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("tracert www.52ztf.cn\n")])])]),a("h2",{attrs:{id:"网卡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网卡"}},[t._v("#")]),t._v(" 网卡")]),t._v(" "),a("h3",{attrs:{id:"mtu"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mtu"}},[t._v("#")]),t._v(" MTU")]),t._v(" "),a("blockquote",[a("p",[t._v("MTU经过网卡传输的数据包的最大传输单元,传输设备的MTU值不规范造成传输失败的情况")])]),t._v(" "),a("p",[a("strong",[t._v("查看MTU值")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /sys/class/net/eth0/mtu\n")])])]),a("p",[a("strong",[t._v("临时更改MTU值")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1476"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /sys/class/net/eth0/mtu\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ifconfig 网口名 mtu 数值")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ifconfig")]),t._v(" eth0 mtu "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1476")]),t._v("\n")])])]),a("p",[a("strong",[t._v("永久更改MTU值")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/sysconfig/network-scripts/ifcfg-eth0\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在DEVICE=eth0下面加入")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MTU")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1476")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用IPv6地址的，修改IPv6 mtu的参数为")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV6_MTU")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1280"')]),t._v("\n")])])]),a("p",[a("strong",[t._v("重启网络接口")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" network restart\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);